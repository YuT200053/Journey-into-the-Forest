import{S as v}from"./sweetalert2.all-DGSmZMaA.js";import{_ as E,c as n,b as i,a as e,e as V,z as x,F as y,q as k,u as L,t as d,w as T,d as q,r as p,o as r,x as S,y as F,s as b,A}from"./index-t10dPIaC.js";var B={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"yu-t-200053",BASE_URL:"/Journey-into-the-Forest/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:m,VITE_PATH:_}=B,g=v.mixin({toast:!0,position:"top-end",showConfirmButton:!1,background:"#f4f9f3",color:"#505843",timer:3e3,timerProgressBar:!0,didOpen:a=>{a.onmouseenter=v.stopTimer,a.onmouseleave=v.resumeTimer}}),M={data(){return{carts:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!1}},methods:{getCart(){const a=`${m}/api/${_}/cart`;this.isLoading=!0,this.axios.get(a).then(t=>{this.carts=t.data.data,this.isLoading=!1}).catch(t=>{alert(t.response.data.message)})},deleteCart(a){const t=`${m}/api/${_}/cart/${a}`;this.axios.delete(t).then(()=>{this.getCart(),g.fire({icon:"success",title:"已刪除此產品！"})}).catch(c=>{alert(c.response.data.message)})},deleteAll(){const a=`${m}/api/${_}/carts`;this.axios.delete(a).then(()=>{this.getCart(),g.fire({icon:"success",title:"已清空購物車！"})}).catch(t=>{alert(t.response.data.message)})},changeQty(a,t){const c={product_id:a.product_id,qty:t},C=`${m}/api/${_}/cart/${a.id}`;this.axios.put(C,{data:c}).then(()=>{this.getCart(),g.fire({icon:"success",title:"已更新產品數量！"})}).catch(s=>{alert(s.response.data.message)})},createOrder(){const a=`${m}/api/${_}/order`,t=this.form;this.axios.post(a,{data:t}).then(()=>{g.fire({icon:"success",title:"已成功送出訂單！"}),this.$router.push("/")}).catch(c=>{alert(c.response.data.message)})}},mounted(){this.getCart()}},D=q('<section class="cart-banner img-box mb-4"><div class="container"><div class="cart-banner-title text-center w-100"><h1 class="title mb-0">購物車</h1><span class="english fs-5 title">Cart</span></div></div></section>',1),I={class:"container mb-7"},N={key:0,class:"alert alert-secondary border border-1 text-center",role:"alert"},O=e("i",{class:"bi bi-stars me-1"},null,-1),P={class:"row"},R={class:"col-12 col-lg-8 mb-5 mb-lg-0"},z=["disabled","onClick"],H=e("i",{class:"bi bi-x-lg"},null,-1),Q=[H],j={class:"row gx-2 align-items-center"},J={class:"col-12 col-sm-3 mb-1 mb-sm-0"},G=["src","alt"],K={class:"col-12 col-sm-5 mb-1 mb-sm-0"},W={class:"fs-5"},X=e("br",null,null,-1),Y={class:"text-muted fs-7"},Z={class:"text-dark-green"},$={class:"col-12 col-sm-2"},ee=["disabled","onUpdate:modelValue","onChange"],se=["value"],te={class:"col-12 col-sm-2 text-end text-primary"},oe={key:0,class:"d-flex justify-content-between pe-3"},le=["disabled"],ae=e("i",{class:"bi bi-trash3 me-1"},null,-1),ie={class:"fs-4 text-danger ls-2"},ne={key:0,class:"col-12 col-lg-4"},re={class:"product-description p-5"},ce=e("div",{class:"mb-3"},[e("h4",{class:"title mb-0"},"購買人資料"),e("span",{class:"english title ls-2 fs-7"},"Purchaser Information")],-1),de={class:"form-floating mb-3"},me=e("label",{for:"email"},"Email",-1),_e={class:"form-floating mb-3"},ue=e("label",{for:"name"},"收件人姓名",-1),he={class:"form-floating mb-3"},fe=e("label",{for:"tel"},"收件人電話",-1),pe={class:"form-floating mb-3"},be=e("label",{for:"address"},"收件人地址",-1),ge={class:"form-floating mb-3"},ve=e("label",{for:"message"},"留言",-1),Ve={class:"text-end"},xe=["disabled"],ye=e("i",{class:"bi bi-send me-1"},null,-1);function Ce(a,t,c,C,s,u){const U=p("VueLoading"),h=p("VeeField"),f=p("ErrorMessage"),w=p("VeeForm");return r(),n(y,null,[i(U,{active:s.isLoading},null,8,["active"]),D,e("section",I,[s.carts.carts&&!s.carts.carts.length?(r(),n("div",N,[O,V("目前購物車是空的，趕快加入你的漫遊行程吧！ ")])):x("",!0),e("div",P,[e("div",R,[(r(!0),n(y,null,k(s.carts.carts,o=>(r(),n("div",{class:"p-3 mb-2 bg-secondary rounded-3 d-flex border border-1",key:o.id},[e("button",{type:"button",class:"btn ps-0",disabled:s.isLoading,onClick:L(l=>u.deleteCart(o.id),["prevent"])},Q,8,z),e("div",j,[e("div",J,[e("img",{src:o.product.imageUrl,alt:o.product.title,class:"w-100 rounded-3"},null,8,G)]),e("div",K,[e("span",W,d(o.product.title),1),X,e("del",Y," 原 $"+d(o.product.origin_price?o.product.origin_price.toLocaleString("en-US"):""),1),e("span",Z," 特價 $"+d(o.product.price?o.product.price.toLocaleString("en-US"):""),1)]),e("div",$,[S(e("select",{class:"form-select form-select-sm mb-1 mb-sm-0",disabled:s.isLoading,"onUpdate:modelValue":l=>o.qty=l,onChange:l=>u.changeQty(o,o.qty)},[(r(),n(y,null,k(10,l=>e("option",{key:l,value:l},d(l)+" 張",9,se)),64))],40,ee),[[F,o.qty]])]),e("div",te," 小計 $"+d(o.total?o.total.toLocaleString("en-US"):""),1)])]))),128)),s.carts.carts&&s.carts.carts.length?(r(),n("div",oe,[e("button",{type:"button",class:"btn btn-outline-dark-green",disabled:s.isLoading,onClick:t[0]||(t[0]=L(o=>u.deleteAll(),["prevent"]))},[ae,V("清空購物車 ")],8,le),e("div",ie," 總計 $"+d(s.carts.total?s.carts.total.toLocaleString("en-US"):""),1)])):x("",!0)]),s.carts.carts&&s.carts.carts.length?(r(),n("div",ne,[e("div",re,[ce,i(w,{onSubmit:t[6]||(t[6]=o=>u.createOrder()),ref:"form"},{default:T(({errors:o})=>[e("div",de,[i(h,{id:"email",name:"email",type:"email",class:b(["form-control",{"is-invalid":o.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:s.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=l=>s.form.user.email=l)},null,8,["class","modelValue"]),me,i(f,{name:"email",class:"invalid-feedback"})]),e("div",_e,[i(h,{id:"name",name:"姓名",type:"name",class:b(["form-control",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:s.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=l=>s.form.user.name=l)},null,8,["class","modelValue"]),ue,i(f,{name:"姓名",class:"invalid-feedback"})]),e("div",he,[i(h,{id:"tel",name:"電話",type:"tel",class:b(["form-control",{"is-invalid":o.電話}]),placeholder:"請輸入電話",rules:"required|min:8||numeric",modelValue:s.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=l=>s.form.user.tel=l)},null,8,["class","modelValue"]),fe,i(f,{name:"電話",class:"invalid-feedback"})]),e("div",pe,[i(h,{id:"address",name:"地址",type:"text",class:b(["form-control",{"is-invalid":o.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:s.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=l=>s.form.user.address=l)},null,8,["class","modelValue"]),be,i(f,{name:"地址",class:"invalid-feedback"})]),e("div",ge,[S(e("textarea",{id:"message",name:"留言",class:"form-control",placeholder:"請輸入留言","onUpdate:modelValue":t[5]||(t[5]=l=>s.form.message=l)},null,512),[[A,s.form.message]]),ve]),e("div",Ve,[e("button",{type:"submit",class:"btn btn-primary text-white",disabled:s.carts.carts?s.carts.carts.final_total:""===0},[ye,V("送出訂單 ")],8,xe)])]),_:1},512)])])):x("",!0)])])],64)}const Se=E(M,[["render",Ce]]);export{Se as default};
