import{S as v}from"./sweetalert2.all-4SRLh2Qf.js";import{_ as E,c as r,b as n,a as e,e as x,z as V,F as y,s as k,u as L,t as d,w as T,d as q,r as p,o as c,x as S,y as M,n as b,A as F}from"./index-CKHe_CXP.js";var A={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"yu-t-200053",BASE_URL:"/Journey-into-the-Forest/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:m,VITE_PATH:u}=A,g=v.mixin({toast:!0,position:"top-end",showConfirmButton:!1,background:"#f4f9f3",color:"#505843",timer:3e3,timerProgressBar:!0,didOpen:l=>{l.onmouseenter=v.stopTimer,l.onmouseleave=v.resumeTimer}}),U=v.mixin({background:"#f4f9f3",color:"#505843",confirmButtonText:"確定",confirmButtonColor:"#7d8b72",showCancelButton:!0,cancelButtonText:"取消",customClass:{cancelButton:"cancelBtn"}}),D={data(){return{carts:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!1}},methods:{getCart(){const l=`${m}/api/${u}/cart`;this.isLoading=!0,this.axios.get(l).then(s=>{this.carts=s.data.data,this.isLoading=!1}).catch(s=>{alert(s.response.data.message)})},deleteModal(l,s){l?U.fire({icon:"question",title:"確定要清空購物車嗎？"}).then(a=>{a.isConfirmed&&this.deleteAll()}):U.fire({icon:"question",title:`確定要刪除「${s.product.title}」嗎？`}).then(a=>{a.isConfirmed&&this.deleteCart(s.id)})},deleteCart(l){const s=`${m}/api/${u}/cart/${l}`;console.log(l),this.axios.delete(s).then(()=>{this.getCart(),g.fire({icon:"success",title:"已刪除此產品！"})}).catch(a=>{alert(a.response.data.message)})},deleteAll(){const l=`${m}/api/${u}/carts`;this.axios.delete(l).then(()=>{this.getCart(),g.fire({icon:"success",title:"已清空購物車！"})}).catch(s=>{alert(s.response.data.message)})},changeQty(l,s){const a={product_id:l.product_id,qty:s},C=`${m}/api/${u}/cart/${l.id}`;this.axios.put(C,{data:a}).then(()=>{this.getCart(),g.fire({icon:"success",title:"已更新產品數量！"})}).catch(t=>{alert(t.response.data.message)})},createOrder(){const l=`${m}/api/${u}/order`,s=this.form;this.axios.post(l,{data:s}).then(()=>{g.fire({icon:"success",title:"已成功送出訂單！"}),this.$router.push("/")}).catch(a=>{alert(a.response.data.message)})}},mounted(){this.getCart()}},I=q('<section class="cart-banner img-box mb-4"><div class="container"><div class="cart-banner-title text-center w-100"><h1 class="title mb-0">購物車</h1><span class="english fs-5 title">Cart</span></div></div></section>',1),N={class:"container mb-7"},O={key:0,class:"alert alert-secondary border border-1 text-center",role:"alert"},P=e("i",{class:"bi bi-stars me-1"},null,-1),R={class:"row"},z={class:"col-12 col-lg-8 mb-5 mb-lg-0"},H=["disabled","onClick"],Q=e("i",{class:"bi bi-x-lg"},null,-1),j=[Q],J={class:"row gx-2 align-items-center"},G={class:"col-12 col-sm-3 mb-1 mb-sm-0"},K=["src","alt"],W={class:"col-12 col-sm-5 mb-1 mb-sm-0"},X={class:"fs-5"},Y=e("br",null,null,-1),Z={class:"text-muted fs-7"},$={class:"text-dark-green"},ee={class:"col-12 col-sm-2"},se=["disabled","onUpdate:modelValue","onChange"],te=["value"],oe={class:"col-12 col-sm-2 text-end text-primary"},le={key:0,class:"d-flex justify-content-between pe-3"},ie=["disabled"],ae=e("i",{class:"bi bi-trash3 me-1"},null,-1),ne={class:"fs-4 text-danger ls-2"},re={key:0,class:"col-12 col-lg-4"},ce={class:"product-description p-5"},de=e("div",{class:"mb-3"},[e("h4",{class:"title mb-0"},"購買人資料"),e("span",{class:"english title ls-2 fs-7"},"Purchaser Information")],-1),me={class:"form-floating mb-3"},ue=e("label",{for:"email"},"Email",-1),_e={class:"form-floating mb-3"},fe=e("label",{for:"name"},"收件人姓名",-1),he={class:"form-floating mb-3"},pe=e("label",{for:"tel"},"收件人電話",-1),be={class:"form-floating mb-3"},ge=e("label",{for:"address"},"收件人地址",-1),ve={class:"form-floating mb-3"},xe=e("label",{for:"message"},"留言",-1),Ve={class:"text-end"},ye=["disabled"],Ce=e("i",{class:"bi bi-send me-1"},null,-1);function ke(l,s,a,C,t,_){const w=p("VueLoading"),f=p("VeeField"),h=p("ErrorMessage"),B=p("VeeForm");return c(),r(y,null,[n(w,{active:t.isLoading},null,8,["active"]),I,e("section",N,[t.carts.carts&&!t.carts.carts.length?(c(),r("div",O,[P,x("目前購物車是空的，趕快加入你的漫遊行程吧！ ")])):V("",!0),e("div",R,[e("div",z,[(c(!0),r(y,null,k(t.carts.carts,o=>(c(),r("div",{class:"p-3 mb-2 bg-secondary rounded-3 d-flex border border-1",key:o.id},[e("button",{type:"button",class:"btn ps-0",disabled:t.isLoading,onClick:L(i=>_.deleteModal(!1,o),["prevent"])},j,8,H),e("div",J,[e("div",G,[e("img",{src:o.product.imageUrl,alt:o.product.title,class:"w-100 rounded-3"},null,8,K)]),e("div",W,[e("span",X,d(o.product.title),1),Y,e("del",Z," 原 $"+d(o.product.origin_price?o.product.origin_price.toLocaleString("en-US"):""),1),e("span",$," 特價 $"+d(o.product.price?o.product.price.toLocaleString("en-US"):""),1)]),e("div",ee,[S(e("select",{class:"form-select form-select-sm mb-1 mb-sm-0",disabled:t.isLoading,"onUpdate:modelValue":i=>o.qty=i,onChange:i=>_.changeQty(o,o.qty)},[(c(),r(y,null,k(10,i=>e("option",{key:i,value:i},d(i)+" 張",9,te)),64))],40,se),[[M,o.qty]])]),e("div",oe," 小計 $"+d(o.total?o.total.toLocaleString("en-US"):""),1)])]))),128)),t.carts.carts&&t.carts.carts.length?(c(),r("div",le,[e("button",{type:"button",class:"btn btn-outline-dark-green",disabled:t.isLoading,onClick:s[0]||(s[0]=L(o=>_.deleteModal(!0),["prevent"]))},[ae,x("清空購物車 ")],8,ie),e("div",ne," 總計 $"+d(t.carts.total?t.carts.total.toLocaleString("en-US"):""),1)])):V("",!0)]),t.carts.carts&&t.carts.carts.length?(c(),r("div",re,[e("div",ce,[de,n(B,{onSubmit:s[6]||(s[6]=o=>_.createOrder()),ref:"form"},{default:T(({errors:o})=>[e("div",me,[n(f,{id:"email",name:"email",type:"email",class:b(["form-control",{"is-invalid":o.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:t.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=i=>t.form.user.email=i)},null,8,["class","modelValue"]),ue,n(h,{name:"email",class:"invalid-feedback"})]),e("div",_e,[n(f,{id:"name",name:"姓名",type:"name",class:b(["form-control",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:t.form.user.name,"onUpdate:modelValue":s[2]||(s[2]=i=>t.form.user.name=i)},null,8,["class","modelValue"]),fe,n(h,{name:"姓名",class:"invalid-feedback"})]),e("div",he,[n(f,{id:"tel",name:"電話",type:"tel",class:b(["form-control",{"is-invalid":o.電話}]),placeholder:"請輸入電話",rules:"required|min:8||numeric",modelValue:t.form.user.tel,"onUpdate:modelValue":s[3]||(s[3]=i=>t.form.user.tel=i)},null,8,["class","modelValue"]),pe,n(h,{name:"電話",class:"invalid-feedback"})]),e("div",be,[n(f,{id:"address",name:"地址",type:"text",class:b(["form-control",{"is-invalid":o.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:t.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=i=>t.form.user.address=i)},null,8,["class","modelValue"]),ge,n(h,{name:"地址",class:"invalid-feedback"})]),e("div",ve,[S(e("textarea",{id:"message",name:"留言",class:"form-control",placeholder:"請輸入留言","onUpdate:modelValue":s[5]||(s[5]=i=>t.form.message=i)},null,512),[[F,t.form.message]]),xe]),e("div",Ve,[e("button",{type:"submit",class:"btn btn-primary text-white",disabled:t.carts.carts?t.carts.carts.final_total:""===0},[Ce,x("送出訂單 ")],8,ye)])]),_:1},512)])])):V("",!0)])])],64)}const Ue=E(D,[["render",ke]]);export{Ue as default};
