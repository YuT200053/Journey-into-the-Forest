import{z as w,_ as T,c as r,b as n,a as e,f as x,A as V,F as y,u as S,d as k,t as d,w as q,e as M,r as p,o as c,x as L,y as F,n as b,B as A}from"./index-BrxvJFqZ.js";import{S as v}from"./sweetalert2.all-Uy1Zp1uU.js";w("cartStore",{state:()=>({cart:[]}),actions:{}});var N={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"yu-t-200053",VITE_BASE_URL:"/Journey-into-the-Forest/",BASE_URL:"/Journey-into-the-Forest/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:u,VITE_PATH:_}=N,g=v.mixin({toast:!0,position:"top-end",showConfirmButton:!1,background:"#f4f9f3",color:"#505843",timer:3e3,timerProgressBar:!0,didOpen:l=>{l.onmouseenter=v.stopTimer,l.onmouseleave=v.resumeTimer}}),U=v.mixin({background:"#f4f9f3",color:"#505843",confirmButtonText:"確定",confirmButtonColor:"#7d8b72",showCancelButton:!0,cancelButtonText:"取消",customClass:{cancelButton:"cancelBtn"}}),P={data(){return{carts:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!1}},methods:{getCart(){const l=`${u}/api/${_}/cart`;this.isLoading=!0,this.axios.get(l).then(s=>{this.carts=s.data.data,this.isLoading=!1}).catch(s=>{alert(s.response.data.message)})},deleteModal(l,s){l?U.fire({icon:"question",title:"確定要清空購物車嗎？"}).then(a=>{a.isConfirmed&&this.deleteAll()}):U.fire({icon:"question",title:`確定要刪除「${s.product.title}」嗎？`}).then(a=>{a.isConfirmed&&this.deleteCart(s.id)})},deleteCart(l){const s=`${u}/api/${_}/cart/${l}`;console.log(l),this.axios.delete(s).then(()=>{this.getCart(),g.fire({icon:"success",title:"已刪除此產品！"})}).catch(a=>{alert(a.response.data.message)})},deleteAll(){const l=`${u}/api/${_}/carts`;this.axios.delete(l).then(()=>{this.getCart(),g.fire({icon:"success",title:"已清空購物車！"})}).catch(s=>{alert(s.response.data.message)})},changeQty(l,s){const a={product_id:l.product_id,qty:s},C=`${u}/api/${_}/cart/${l.id}`;this.axios.put(C,{data:a}).then(()=>{this.getCart(),g.fire({icon:"success",title:"已更新產品數量！"})}).catch(t=>{alert(t.response.data.message)})},createOrder(){const l=`${u}/api/${_}/order`,s=this.form;this.axios.post(l,{data:s}).then(()=>{g.fire({icon:"success",title:"已成功送出訂單！"}),this.$router.push("/")}).catch(a=>{alert(a.response.data.message)})},isPhone(l){return/^(09)[0-9]{8}$/.test(l)?!0:"請正確的手機號碼"}},mounted(){this.getCart()}},I=M('<section class="cart-banner img-box mb-4"><div class="container"><div class="cart-banner-title text-center w-100"><h1 class="title mb-0">購物車</h1><span class="english fs-5 title">Cart</span></div></div></section>',1),R={class:"container mb-7"},D={key:0,class:"text-center text-muted",role:"alert"},O=e("i",{class:"bi bi-stars me-1"},null,-1),z={class:"row"},H={class:"col-12 col-lg-8 mb-5 mb-lg-0"},J=["disabled","onClick"],Q=e("i",{class:"bi bi-x-lg"},null,-1),j=[Q],G={class:"row gx-2 align-items-center"},K={class:"col-12 col-sm-3 mb-1 mb-sm-0"},W=["src","alt"],X={class:"col-12 col-sm-5 mb-1 mb-sm-0"},Y={class:"fs-5"},Z=e("br",null,null,-1),$={class:"text-muted fs-7"},ee={class:"text-dark-green"},se={class:"col-12 col-sm-2"},te=["disabled","onUpdate:modelValue","onChange"],oe=["value"],le={class:"col-12 col-sm-2 text-end text-primary"},ie={key:0,class:"d-flex justify-content-between pe-3"},ae=["disabled"],ne=e("i",{class:"bi bi-trash3 me-1"},null,-1),re={class:"fs-4 text-danger ls-2"},ce={key:0,class:"col-12 col-lg-4"},de={class:"product-description p-5"},me=e("div",{class:"mb-3"},[e("h4",{class:"title mb-0"},"購買人資料"),e("span",{class:"english title ls-2 fs-7"},"Purchaser Information")],-1),ue={class:"form-floating mb-3"},_e=e("label",{for:"email"},"Email",-1),he={class:"form-floating mb-3"},fe=e("label",{for:"name"},"收件人姓名",-1),pe={class:"form-floating mb-3"},be=e("label",{for:"tel"},"收件人電話",-1),ge={class:"form-floating mb-3"},ve=e("label",{for:"address"},"收件人地址",-1),xe={class:"form-floating mb-3"},Ve=e("label",{for:"message"},"留言",-1),ye={class:"text-end"},Ce=["disabled"],Se=e("i",{class:"bi bi-send me-1"},null,-1);function ke(l,s,a,C,t,m){const B=p("VueLoading"),h=p("VeeField"),f=p("ErrorMessage"),E=p("VeeForm");return c(),r(y,null,[n(B,{active:t.isLoading},null,8,["active"]),I,e("section",R,[t.carts.carts&&!t.carts.carts.length?(c(),r("div",D,[O,x("目前購物車是空的，趕快加入你的漫遊行程吧！ ")])):V("",!0),e("div",z,[e("div",H,[(c(!0),r(y,null,S(t.carts.carts,o=>(c(),r("div",{class:"p-3 mb-2 bg-secondary rounded-3 d-flex border border-1",key:o.id},[e("button",{type:"button",class:"btn ps-0",disabled:t.isLoading,onClick:k(i=>m.deleteModal(!1,o),["prevent"])},j,8,J),e("div",G,[e("div",K,[e("img",{src:o.product.imageUrl,alt:o.product.title,class:"w-100 rounded-3"},null,8,W)]),e("div",X,[e("span",Y,d(o.product.title),1),Z,e("del",$," 原 $"+d(o.product.origin_price?o.product.origin_price.toLocaleString("en-US"):""),1),e("span",ee," 特價 $"+d(o.product.price?o.product.price.toLocaleString("en-US"):""),1)]),e("div",se,[L(e("select",{class:"form-select form-select-sm mb-1 mb-sm-0",disabled:t.isLoading,"onUpdate:modelValue":i=>o.qty=i,onChange:i=>m.changeQty(o,o.qty)},[(c(),r(y,null,S(10,i=>e("option",{key:i,value:i},d(i)+" 張",9,oe)),64))],40,te),[[F,o.qty]])]),e("div",le," 小計 $"+d(o.total?o.total.toLocaleString("en-US"):""),1)])]))),128)),t.carts.carts&&t.carts.carts.length?(c(),r("div",ie,[e("button",{type:"button",class:"btn btn-outline-dark-green",disabled:t.isLoading,onClick:s[0]||(s[0]=k(o=>m.deleteModal(!0),["prevent"]))},[ne,x("清空購物車 ")],8,ae),e("div",re," 總計 $"+d(t.carts.total?t.carts.total.toLocaleString("en-US"):""),1)])):V("",!0)]),t.carts.carts&&t.carts.carts.length?(c(),r("div",ce,[e("div",de,[me,n(E,{onSubmit:s[6]||(s[6]=o=>m.createOrder()),ref:"form"},{default:q(({errors:o})=>[e("div",ue,[n(h,{id:"email",name:"email",type:"email",class:b(["form-control",{"is-invalid":o.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:t.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=i=>t.form.user.email=i)},null,8,["class","modelValue"]),_e,n(f,{name:"email",class:"invalid-feedback"})]),e("div",he,[n(h,{id:"name",name:"姓名",type:"name",class:b(["form-control",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:t.form.user.name,"onUpdate:modelValue":s[2]||(s[2]=i=>t.form.user.name=i)},null,8,["class","modelValue"]),fe,n(f,{name:"姓名",class:"invalid-feedback"})]),e("div",pe,[n(h,{id:"tel",name:"電話",type:"number",class:b(["form-control",{"is-invalid":o.電話}]),placeholder:"請輸入電話",rules:m.isPhone,modelValue:t.form.user.tel,"onUpdate:modelValue":s[3]||(s[3]=i=>t.form.user.tel=i)},null,8,["class","rules","modelValue"]),be,n(f,{name:"電話",class:"invalid-feedback"})]),e("div",ge,[n(h,{id:"address",name:"地址",type:"text",class:b(["form-control",{"is-invalid":o.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:t.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=i=>t.form.user.address=i)},null,8,["class","modelValue"]),ve,n(f,{name:"地址",class:"invalid-feedback"})]),e("div",xe,[L(e("textarea",{id:"message",name:"留言",class:"form-control",placeholder:"請輸入留言","onUpdate:modelValue":s[5]||(s[5]=i=>t.form.message=i)},null,512),[[A,t.form.message]]),Ve]),e("div",ye,[e("button",{type:"submit",class:"btn btn-primary text-white",disabled:t.carts.carts?t.carts.carts.final_total:""===0},[Se,x("送出訂單 ")],8,Ce)])]),_:1},512)])])):V("",!0)])])],64)}const Be=T(P,[["render",ke]]);export{Be as default};
